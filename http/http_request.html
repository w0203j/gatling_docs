

<ol class="breadcrumb">
  <li><a href="../index.html">Gatling documentation</a></li>
  <li><a href="index.html" accesskey="U">
    HTTP
    </a>
  </li>
  <li><a href="">
    HTTP Request
  </a></li>
</ol>

<div class="content-left-wrap col-md-9">
  <div id="primary" class="content-area">
    <main itemscope="" itemtype="http://schema.org/WebPageElement" itemprop="mainContentOfPage" id="main"
          class="site-main">
      <article id="documentation" class="type-post status-publish format-standard hentry category-non-classe">
        <header class="entry-header">
          <h1 class="entry-title" itemprop="headline">HTTP Request</h1>
        </header>
        <div class="entry-content" itemprop="text">
          
          <div class="section" id="http-request">
<span id="id1"></span>
<p>HTTP support has a dedicated DSL, whose entry point is the <code class="docutils literal"><span class="pre">http(requestName:</span> <span class="pre">Expression[String])</span></code> method.</p>
<p>This request name is important because it will act as a key when computing stats for the reports.
If the same name appears in multiple places in a Simulation, Gatling will consider those requests are of the same type and their statistics will be aggregated.</p>
<p>HTTP requests have to be passed to the <code class="docutils literal"><span class="pre">exec()</span></code> method in order to be attached to the scenario and be executed.</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="c1">// embedded style</span>
<span class="n">scenario</span><span class="o">(</span><span class="s">&quot;MyScenario&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">exec</span><span class="o">(</span><span class="n">http</span><span class="o">(</span><span class="s">&quot;RequestName&quot;</span><span class="o">).</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;url&quot;</span><span class="o">))</span>

<span class="c1">// non embedded style</span>
<span class="k">val</span> <span class="n">request</span> <span class="k">=</span> <span class="n">http</span><span class="o">(</span><span class="s">&quot;RequestName&quot;</span><span class="o">).</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;url&quot;</span><span class="o">)</span>

<span class="n">scenario</span><span class="o">(</span><span class="s">&quot;MyScenario&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">exec</span><span class="o">(</span><span class="n">request</span><span class="o">)</span>
</pre></div>
</div>
<div class="section" id="method-and-url">
<span id="http-request-methods"></span><h2>Method and URL<a class="headerlink" href="#method-and-url" title="Permalink to this headline">¶</a></h2>
<p>HTTP protocol requires 2 mandatory parameters: the method and the URL.</p>
<p>Gatling provides built-ins for the most common methods. Those are simply the method name in minor case:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">get(url:</span> <span class="pre">Expression[String])</span></code></li>
<li><code class="docutils literal"><span class="pre">put(url:</span> <span class="pre">Expression[String])</span></code></li>
<li><code class="docutils literal"><span class="pre">post(url:</span> <span class="pre">Expression[String])</span></code></li>
<li><code class="docutils literal"><span class="pre">delete(url:</span> <span class="pre">Expression[String])</span></code></li>
<li><code class="docutils literal"><span class="pre">head(url:</span> <span class="pre">Expression[String])</span></code></li>
<li><code class="docutils literal"><span class="pre">patch(url:</span> <span class="pre">Expression[String])</span></code></li>
<li><code class="docutils literal"><span class="pre">options(url:</span> <span class="pre">Expression[String])</span></code></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These methods are the ones used in REST web services and RESTful applications; thus, such services can be tested with Gatling.</p>
</div>
<p>Gatling also supports custom methods (e.g. you can use the method <em>PURGE</em> to purge Nginx cache):</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">httpRequest(method:</span> <span class="pre">String,</span> <span class="pre">url:</span> <span class="pre">Expression[String])</span></code></li>
<li><code class="docutils literal"><span class="pre">httpRequestWithParams(method:</span> <span class="pre">String,</span> <span class="pre">url:</span> <span class="pre">Expression[String])</span></code> for extending <code class="docutils literal"><span class="pre">post</span></code></li>
</ul>
<p>This is how an HTTP request is declared:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="c1">// general structure of an HTTP request</span>
<span class="n">http</span><span class="o">(</span><span class="n">requestName</span><span class="o">).</span><span class="n">method</span><span class="o">(</span><span class="n">url</span><span class="o">)</span>

<span class="c1">// concrete examples</span>
<span class="n">http</span><span class="o">(</span><span class="s">&quot;Retrieve home page&quot;</span><span class="o">).</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://github.com/gatling/gatling&quot;</span><span class="o">)</span>
<span class="n">http</span><span class="o">(</span><span class="s">&quot;Login&quot;</span><span class="o">).</span><span class="n">post</span><span class="o">(</span><span class="s">&quot;https://github.com/session&quot;</span><span class="o">)</span>
<span class="n">http</span><span class="o">(</span><span class="s">&quot;Nginx cache purge&quot;</span><span class="o">).</span><span class="n">httpRequest</span><span class="o">(</span><span class="s">&quot;PURGE&quot;</span><span class="o">,</span> <span class="s">&quot;http://myNginx.com&quot;</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="query-parameters">
<span id="http-request-query-parameters"></span><h2>Query Parameters<a class="headerlink" href="#query-parameters" title="Permalink to this headline">¶</a></h2>
<p>Frameworks and developers often pass additional information in the query, which is the part of the url after the <code class="docutils literal"><span class="pre">?</span></code>. A query is composed of <em>key=value</em> pairs, separated by <code class="docutils literal"><span class="pre">&amp;</span></code>. Those are named <em>query parameters</em>.</p>
<p>For example, <code class="docutils literal"><span class="pre">https://github.com/gatling/gatling/issues?milestone=1&amp;state=open</span></code> contains 2 query parameters:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">milestone=1</span></code> : the key is <em>milestone</em> and its value is <em>1</em></li>
<li><code class="docutils literal"><span class="pre">state=open</span></code> : the key is <em>state</em> and its value is <em>open</em></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Query parameter keys and values have to be <a class="reference external" href="http://www.w3schools.com/tags/ref_urlencode.asp">URL encoded</a>, as per <a class="reference external" href="http://tools.ietf.org/html/rfc3986">RFC3986</a>.
Sometimes, HTTP server implementations are very permissive, but Gatling currently isn’t and sticks to the RFC.</p>
</div>
<p>In order to set the query parameters of an HTTP request, you can:</p>
<ul>
<li><p class="first">either pass the full query in the url, e.g.:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;Getting issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://github.com/gatling/gatling/issues?milestone=1&amp;state=open&quot;</span><span class="o">)</span>
</pre></div>
</div>
</li>
<li><p class="first">or pass query parameters one by one to the method named <code class="docutils literal"><span class="pre">queryParam(key:</span> <span class="pre">Expression[String],</span> <span class="pre">value:</span> <span class="pre">Expression[Any])</span></code>, e.g.:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;Getting issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://github.com/gatling/gatling/issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">queryParam</span><span class="o">(</span><span class="s">&quot;milestone&quot;</span><span class="o">,</span> <span class="s">&quot;1&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">queryParam</span><span class="o">(</span><span class="s">&quot;state&quot;</span><span class="o">,</span> <span class="s">&quot;open&quot;</span><span class="o">)</span>
</pre></div>
</div>
</li>
</ul>
<p>Of course, you can use <a class="reference internal" href="../session/expression_el.html#el"><span class="std std-ref">Gatling Expression Language (EL)</span></a> to make those values dynamic based on data in the virtual user’s session:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;Value from session example&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://github.com/gatling/gatling&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">queryParam</span><span class="o">(</span><span class="s">&quot;myKey&quot;</span><span class="o">,</span> <span class="s">&quot;${sessionKey}&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>If you’d like to specify a query parameter without value, you have to use <code class="docutils literal"><span class="pre">queryParam(&quot;key&quot;,</span> <span class="pre">&quot;&quot;)</span></code>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="c1">// GET https://github.com/gatling/gatling?myKey</span>
<span class="n">http</span><span class="o">(</span><span class="s">&quot;Empty value example&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://github.com/gatling/gatling&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">queryParam</span><span class="o">(</span><span class="s">&quot;myKey&quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>If you’d like to pass multiple values for your parameter, but all at once, you can use <code class="docutils literal"><span class="pre">multivaluedQueryParam(key:</span> <span class="pre">Expression[String],</span> <span class="pre">values:</span> <span class="pre">Expression[Seq[Any]])</span></code>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;Request with multivaluedQueryParam&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;myUrl&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">multivaluedQueryParam</span><span class="o">(</span><span class="s">&quot;multi1&quot;</span><span class="o">,</span> <span class="s">&quot;${foo}&quot;</span><span class="o">)</span> <span class="c1">// where foo is the name of a Seq Session attribute</span>
  <span class="o">.</span><span class="n">multivaluedQueryParam</span><span class="o">(</span><span class="s">&quot;multi2&quot;</span><span class="o">,</span> <span class="n">session</span> <span class="k">=&gt;</span> <span class="nc">Seq</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="s">&quot;bar&quot;</span><span class="o">))</span>
</pre></div>
</div>
<p>If you want to add multiple query parameters at once, there are two suitable methods:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">queryParamSeq(seq:</span> <span class="pre">Expression[Seq[(String,</span> <span class="pre">Any)]])</span></code></p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;Getting issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://github.com/gatling/gatling/issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">queryParamSeq</span><span class="o">(</span><span class="nc">Seq</span><span class="o">((</span><span class="s">&quot;milestone&quot;</span><span class="o">,</span> <span class="s">&quot;1&quot;</span><span class="o">),</span> <span class="o">(</span><span class="s">&quot;state&quot;</span><span class="o">,</span> <span class="s">&quot;open&quot;</span><span class="o">)))</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">queryParamMap(map:</span> <span class="pre">Expression[Map[String,</span> <span class="pre">Any]])</span></code></p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;Getting issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://github.com/gatling/gatling/issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">queryParamMap</span><span class="o">(</span><span class="nc">Map</span><span class="o">(</span><span class="s">&quot;milestone&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;1&quot;</span><span class="o">,</span> <span class="s">&quot;state&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;open&quot;</span><span class="o">))</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As all method parameters are <code class="docutils literal"><span class="pre">Expression[T]</span></code>, i.e. ‘key’ parameter is an <code class="docutils literal"><span class="pre">Expression[String]</span></code> and so on, if you have more specific needs you can also provide an arbitrary <code class="docutils literal"><span class="pre">Expression[T]</span></code>, i.e. a <code class="docutils literal"><span class="pre">Session</span> <span class="pre">=&gt;</span> <span class="pre">Validation[T]</span></code> function.
This function will be evaluated against the user session every time this one pass through it.
For a deeper look at <cite>Expression</cite> see dedicated section <a class="reference internal" href="../session/expression_el.html#expression"><span class="std std-ref">here</span></a>.</p>
</div>
</div>
<div class="section" id="headers">
<span id="http-request-headers"></span><h2>Headers<a class="headerlink" href="#headers" title="Permalink to this headline">¶</a></h2>
<p>HTTP protocol uses headers to exchange information between client and server that is not part of the message (stored in the body of the request, if there is one).</p>
<p>Gatling HTTP allows you to specify any header you want to with the <code class="docutils literal"><span class="pre">header(name:</span> <span class="pre">String,</span> <span class="pre">value:</span> <span class="pre">Expression[String])</span></code> and <code class="docutils literal"><span class="pre">headers(newHeaders:</span> <span class="pre">Map[String,</span> <span class="pre">String])</span></code> methods.</p>
<p>Here are some examples:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="c1">// Defining a map of headers before the scenario allows you to reuse these in several requests</span>
<span class="k">val</span> <span class="n">sentHeaders</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="s">&quot;Content-Type&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;application/javascript&quot;</span><span class="o">,</span> <span class="s">&quot;Accept&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;text/html&quot;</span><span class="o">)</span>

<span class="n">http</span><span class="o">(</span><span class="s">&quot;Custom headers&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">post</span><span class="o">(</span><span class="s">&quot;myUrl&quot;</span><span class="o">)</span>
  <span class="c1">// Adds several headers at once</span>
  <span class="o">.</span><span class="n">headers</span><span class="o">(</span><span class="n">sentHeaders</span><span class="o">)</span>
  <span class="c1">// Adds another header to the request</span>
  <span class="o">.</span><span class="n">header</span><span class="o">(</span><span class="s">&quot;Keep-Alive&quot;</span><span class="o">,</span> <span class="s">&quot;150&quot;</span><span class="o">)</span>
  <span class="c1">// Overrides the Content-Type header</span>
  <span class="o">.</span><span class="n">header</span><span class="o">(</span><span class="s">&quot;Content-Type&quot;</span><span class="o">,</span> <span class="s">&quot;application/json&quot;</span><span class="o">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Headers keys are defined as constants usable in the scenario, for example: <code class="docutils literal"><span class="pre">HttpHeaderNames.ContentType</span></code>.
You can find a list of the predefined constants <a class="reference external" href="https://github.com/gatling/gatling/blob/master/gatling-http/src/main/scala/io/gatling/http/Headers.scala">here</a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>There are two handful methods to help you set the required headers for JSON and XML requests:</p>
<ul class="last">
<li><p class="first"><code class="docutils literal"><span class="pre">http(&quot;foo&quot;).get(&quot;bar&quot;).asJSON</span></code> is equivalent to:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">).</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">header</span><span class="o">(</span><span class="nc">HttpHeaderNames</span><span class="o">.</span><span class="nc">ContentType</span><span class="o">,</span> <span class="nc">HttpHeaderValues</span><span class="o">.</span><span class="nc">ApplicationJson</span><span class="o">)</span>
  <span class="o">.</span><span class="n">header</span><span class="o">(</span><span class="nc">HttpHeaderNames</span><span class="o">.</span><span class="nc">Accept</span><span class="o">,</span> <span class="nc">HttpHeaderValues</span><span class="o">.</span><span class="nc">ApplicationJson</span><span class="o">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">http(&quot;foo&quot;).get(&quot;bar&quot;).asXML</span></code> is equivalent to:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">).</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">header</span><span class="o">(</span><span class="nc">HttpHeaderNames</span><span class="o">.</span><span class="nc">ContentType</span><span class="o">,</span> <span class="nc">HttpHeaderValues</span><span class="o">.</span><span class="nc">ApplicationXml</span><span class="o">)</span>
  <span class="o">.</span><span class="n">header</span><span class="o">(</span><span class="nc">HttpHeaderNames</span><span class="o">.</span><span class="nc">Accept</span><span class="o">,</span> <span class="nc">HttpHeaderValues</span><span class="o">.</span><span class="nc">ApplicationXml</span><span class="o">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Headers can also be defined on the <code class="docutils literal"><span class="pre">HttpProtocol</span></code>.</p>
</div>
</div>
<div class="section" id="signature-calculator">
<span id="http-request-signature"></span><h2>Signature Calculator<a class="headerlink" href="#signature-calculator" title="Permalink to this headline">¶</a></h2>
<p>You might want to edit the HTTP requests before they’re being sent over the wire, based on other request information: url, headers and/or body.
For example, you might want to generate some <a class="reference external" href="http://en.wikipedia.org/wiki/Hash-based_message_authentication_code">HMAC</a> header.</p>
<p>This can only happen after Gatling has resolved the request, e.g. computed the body based on a template.</p>
<p>Gatling exposes AsyncHttpClient’s <code class="docutils literal"><span class="pre">SignatureCalculator</span></code> API:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">public</span> <span class="n">interface</span> <span class="nc">SignatureCalculator</span> <span class="o">{</span>
  <span class="n">void</span> <span class="n">calculateAndAddSignature</span><span class="o">(</span><span class="nc">Request</span> <span class="n">request</span><span class="o">,</span>
                                <span class="nc">RequestBuilderBase</span><span class="o">&lt;?&gt;</span> <span class="n">requestBuilder</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">request</span></code> is the immutable object that’s been computed so far, <code class="docutils literal"><span class="pre">requestBuilder</span></code> is the mutable object that will be used to generate the final request.</p>
<p>So, basically, you have to read the proper information from the <code class="docutils literal"><span class="pre">url</span></code> and <code class="docutils literal"><span class="pre">request</span></code> parameters, compute the new information out of them, such as a HMAC header, and set it on the <code class="docutils literal"><span class="pre">requestBuilder</span></code>.</p>
<p>There’s 3 ways to set a SignatureCalculator on a request:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">signatureCalculator</span><span class="o">(</span><span class="n">calculator</span><span class="k">:</span> <span class="kt">SignatureCalculator</span><span class="o">)</span>

<span class="c1">// use this signature if you want to directly pass a function instead of a SignatureCalculator</span>
<span class="o">.</span><span class="n">signatureCalculator</span><span class="o">(</span><span class="n">calculator</span><span class="k">:</span> <span class="o">(</span><span class="kt">Request</span><span class="o">,</span> <span class="kt">RequestBuilderBase</span><span class="o">[</span><span class="k">_</span><span class="o">])</span> <span class="k">=&gt;</span> <span class="nc">Unit</span><span class="o">)</span>

<span class="c1">// use this signature if you need information from the session to compute the signature (e.g. user specific authentication keys)</span>
<span class="c1">// does not work with an anonymous function as in the second signature</span>
<span class="o">.</span><span class="n">signatureCalculator</span><span class="o">(</span><span class="n">calculator</span><span class="k">:</span> <span class="kt">Expression</span><span class="o">[</span><span class="kt">SignatureCalculator</span><span class="o">])</span>
</pre></div>
</div>
</div>
<div class="section" id="authentication">
<span id="http-request-authentication"></span><h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h2>
<p>You can set the authentication methods at request level with these methods:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">basicAuth(username:</span> <span class="pre">Expression[String],</span> <span class="pre">password:</span> <span class="pre">Expression[String])</span></code></li>
<li><code class="docutils literal"><span class="pre">digestAuth(username:</span> <span class="pre">Expression[String],</span> <span class="pre">password:</span> <span class="pre">Expression[String])</span></code></li>
<li><code class="docutils literal"><span class="pre">ntlmAuth(username:</span> <span class="pre">Expression[String],</span> <span class="pre">password:</span> <span class="pre">Expression[String],</span> <span class="pre">ntlmDomain:</span> <span class="pre">Expression[String],</span> <span class="pre">ntlmHost:</span> <span class="pre">Expression[String])</span></code></li>
<li><code class="docutils literal"><span class="pre">authRealm(realm:</span> <span class="pre">Expression[com.ning.http.client.Realm])</span></code></li>
</ul>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;My BASIC secured request&quot;</span><span class="o">).</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;http://my.secured.uri&quot;</span><span class="o">).</span><span class="n">basicAuth</span><span class="o">(</span><span class="s">&quot;myUser&quot;</span><span class="o">,</span> <span class="s">&quot;myPassword&quot;</span><span class="o">)</span>

<span class="n">http</span><span class="o">(</span><span class="s">&quot;My DIGEST secured request&quot;</span><span class="o">).</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;http://my.secured.uri&quot;</span><span class="o">).</span><span class="n">digestAuth</span><span class="o">(</span><span class="s">&quot;myUser&quot;</span><span class="o">,</span> <span class="s">&quot;myPassword&quot;</span><span class="o">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Authentication can also be defined on the <code class="docutils literal"><span class="pre">HttpProtocol</span></code>.</p>
</div>
</div>
<div class="section" id="outgoing-proxy">
<span id="http-request-outgoing-proxy"></span><h2>Outgoing Proxy<a class="headerlink" href="#outgoing-proxy" title="Permalink to this headline">¶</a></h2>
<p>You can tell Gatling to use a proxy to send the HTTP requests.
You can optionally set a different port for HTTPS and credentials:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;Getting issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://github.com/gatling/gatling/issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">proxy</span><span class="o">(</span><span class="nc">Proxy</span><span class="o">(</span><span class="s">&quot;myProxyHost&quot;</span><span class="o">,</span> <span class="mi">8080</span><span class="o">).</span><span class="n">httpsPort</span><span class="o">(</span><span class="mi">8143</span><span class="o">).</span><span class="n">credentials</span><span class="o">(</span><span class="s">&quot;myUsername&quot;</span><span class="o">,</span><span class="s">&quot;myPassword&quot;</span><span class="o">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Proxy can also be defined on the <code class="docutils literal"><span class="pre">HttpProtocol</span></code>.</p>
</div>
</div>
<div class="section" id="virtual-host">
<span id="http-virtual-host"></span><h2>Virtual Host<a class="headerlink" href="#virtual-host" title="Permalink to this headline">¶</a></h2>
<p id="http-request-virtual-host">You can tell Gatling to override the default computed virtual host with the method <code class="docutils literal"><span class="pre">virtualHost(virtualHost:</span> <span class="pre">Expression[String])</span></code>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="c1">// GET https://mobile.github.com/gatling/gatling instead of GET https://www.github.com/gatling/gatling</span>
<span class="n">http</span><span class="o">(</span><span class="s">&quot;Getting issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://www.github.com/gatling/gatling/issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">virtualHost</span><span class="o">(</span><span class="s">&quot;mobile&quot;</span><span class="o">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Virtual Host can also be defined on the <code class="docutils literal"><span class="pre">HttpProtocol</span></code>.</p>
</div>
</div>
<div class="section" id="http-checks">
<h2>HTTP Checks<a class="headerlink" href="#http-checks" title="Permalink to this headline">¶</a></h2>
<p id="http-request-check">You can add checks on a request:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;Getting issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://www.github.com/gatling/gatling/issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">check</span><span class="o">(</span><span class="n">myCheck</span><span class="o">)</span>
</pre></div>
</div>
<p>For more information, see the <a class="reference internal" href="http_check.html#http-check"><span class="std std-ref">HTTP Checks reference section</span></a>.</p>
<p id="http-request-ignore-default-checks">For a given request, you can also disable common checks that were defined on the <code class="docutils literal"><span class="pre">HttpProtocol</span></code> with <code class="docutils literal"><span class="pre">ignoreDefaultChecks</span></code>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;Getting issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://www.github.com/gatling/gatling/issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">ignoreDefaultChecks</span>
</pre></div>
</div>
</div>
<div class="section" id="followredirect">
<h2>FollowRedirect<a class="headerlink" href="#followredirect" title="Permalink to this headline">¶</a></h2>
<p id="http-request-disable-follow-redirect">For a given request, you can use <code class="docutils literal"><span class="pre">disableFollowRedirect</span></code>, just like it can be done globally on the <code class="docutils literal"><span class="pre">HttpProtocol</span></code>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;Getting issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://www.github.com/gatling/gatling/issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">disableFollowRedirect</span>
</pre></div>
</div>
</div>
<div class="section" id="url-encoding">
<span id="http-request-urlencoding"></span><h2>Url Encoding<a class="headerlink" href="#url-encoding" title="Permalink to this headline">¶</a></h2>
<p>Url components are supposed to be <a class="reference external" href="http://www.w3schools.com/tags/ref_urlencode.asp">urlencoded</a>.
Gatling will encode them for you, there might be some corner cases where already encoded components might be encoded twice.</p>
<p>If you know that your urls are already properly encoded, you can disable this feature with <code class="docutils literal"><span class="pre">.disableUrlEncoding</span></code>.</p>
</div>
<div class="section" id="silencing">
<span id="http-request-silencing"></span><h2>Silencing<a class="headerlink" href="#silencing" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="http_protocol.html#http-protocol-silencing"><span class="std std-ref">silencing protocol section</span></a> for more details.</p>
<p id="http-request-silent">You can then make the request <em>silent</em>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;Getting issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://www.github.com/gatling/gatling/issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">silent</span>
</pre></div>
</div>
<p id="http-request-notsilent">You might also want to do the exact opposite, typically on a given resource while resources have been globally turned silent at protocol level:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">resources</span><span class="o">(</span>
  <span class="n">http</span><span class="o">(</span><span class="s">&quot;Gatling Logo&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;http://gatling.io/assets/images/img1.png&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">notSilent</span>
<span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="form-parameters">
<span id="http-parameters"></span><h2>Form Parameters<a class="headerlink" href="#form-parameters" title="Permalink to this headline">¶</a></h2>
<p>Requests can have parameters defined in their body.
This is typically used for form submission, where all the values are stored as POST parameters in the body of the request.</p>
<p>To add such parameters to a POST request, you must use the method <code class="docutils literal"><span class="pre">formParam(key:</span> <span class="pre">Expression[String],</span> <span class="pre">value:</span> <span class="pre">Expression[Any])</span></code> which is actually the same as <code class="docutils literal"><span class="pre">queryParam</span></code> in <strong>terms of usage</strong> (it has the same signatures).</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;My Form Data&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">post</span><span class="o">(</span><span class="s">&quot;my.form-action.uri&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">formParam</span><span class="o">(</span><span class="s">&quot;myKey&quot;</span><span class="o">,</span> <span class="s">&quot;myValue&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>As for <code class="docutils literal"><span class="pre">queryParam</span></code> you have two methods to add multiple parameters at once:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">formParamSeq(seq:</span> <span class="pre">Expression[Seq[(String,</span> <span class="pre">Any)]])</span></code>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;My Form Data&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">post</span><span class="o">(</span><span class="s">&quot;my.form-action.uri&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">formParamSeq</span><span class="o">(</span><span class="nc">Seq</span><span class="o">((</span><span class="s">&quot;myKey&quot;</span><span class="o">,</span> <span class="s">&quot;myValue&quot;</span><span class="o">),</span> <span class="o">(</span><span class="s">&quot;anotherKey&quot;</span><span class="o">,</span> <span class="s">&quot;anotherValue&quot;</span><span class="o">)))</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">formParamMap(map:</span> <span class="pre">Expression[Map[String,</span> <span class="pre">Any]])</span></code>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;My Form Data&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">post</span><span class="o">(</span><span class="s">&quot;my.form-action.uri&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">formParamMap</span><span class="o">(</span><span class="nc">Map</span><span class="o">(</span><span class="s">&quot;myKey&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;myValue&quot;</span><span class="o">,</span> <span class="s">&quot;anotherKey&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;anotherValue&quot;</span><span class="o">))</span>
</pre></div>
</div>
</li>
</ul>
<p>If you’d like to pass multiple values for your parameter, but all at once, you can use <code class="docutils literal"><span class="pre">multivaluedFormParam(key:</span> <span class="pre">Expression[String],</span> <span class="pre">values:</span> <span class="pre">Expression[Seq[Any]])</span></code>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;Request with multivaluedFormParam&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">post</span><span class="o">(</span><span class="s">&quot;myUrl&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">multivaluedFormParam</span><span class="o">(</span><span class="s">&quot;multi1&quot;</span><span class="o">,</span> <span class="s">&quot;${foo}&quot;</span><span class="o">)</span> <span class="c1">// where foo is the name of a Seq Session attribute</span>
  <span class="o">.</span><span class="n">multivaluedFormParam</span><span class="o">(</span><span class="s">&quot;multi2&quot;</span><span class="o">,</span> <span class="n">session</span> <span class="k">=&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="s">&quot;bar&quot;</span><span class="o">))</span>
</pre></div>
</div>
<p>The method <code class="docutils literal"><span class="pre">formParam</span></code> can also take directly an <cite>HttpParam</cite> instance, if you want to build it by hand.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">form(seq:</span> <span class="pre">Expression[Map[String,</span> <span class="pre">Seq[String]])</span></code>:</li>
</ul>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;Request with form&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">post</span><span class="o">(</span><span class="s">&quot;myUrl&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">form</span><span class="o">(</span><span class="s">&quot;${theForm}&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">formParam</span><span class="o">(</span><span class="s">&quot;fieldToOverride&quot;</span><span class="o">,</span> <span class="s">&quot;newValue&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>Typically used after capturing a whole form with a <code class="docutils literal"><span class="pre">form</span></code> check.</p>
<p>You can override the form field values with the <code class="docutils literal"><span class="pre">formParam</span></code> and the likes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Gatling will automatically set the <cite>Content-Type</cite> header for you if you didn’t specify one.
It will use <cite>application/x-www-form-urlencoded</cite> except if there’s also some body parts, in which case it will set <cite>multipart/form-data</cite>.</p>
</div>
</div>
<div class="section" id="multipart-form">
<span id="http-multipart-form"></span><h2>Multipart Form<a class="headerlink" href="#multipart-form" title="Permalink to this headline">¶</a></h2>
<p>This applies only for POST requests. When you find forms asking for text values and a file to upload (usually an email attachment), your browser will send a multipart encoded request.</p>
<p>To define such a request, you have to add the parameters as stated above, and the file to be uploaded at the same time with the following method: <code class="docutils literal"><span class="pre">formUpload(name:</span> <span class="pre">Expression[String],</span> <span class="pre">filePath:</span> <span class="pre">Expression[String])</span></code>.</p>
<p>The uploaded file must be located in <code class="docutils literal"><span class="pre">user-files/bodies</span></code>. The <code class="docutils literal"><span class="pre">Content-Type</span></code> header will be set to <code class="docutils literal"><span class="pre">multipart/form-data</span></code> and the file added in addition to the parameters.</p>
<p>One can call <code class="docutils literal"><span class="pre">formUpload()</span></code> multiple times in order to upload multiple files.</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;My Multipart Request&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">post</span><span class="o">(</span><span class="s">&quot;my.form-action.uri&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">formParam</span><span class="o">(</span><span class="s">&quot;myKey&quot;</span><span class="o">,</span> <span class="s">&quot;myValue&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">formUpload</span><span class="o">(</span><span class="s">&quot;myKey2&quot;</span><span class="o">,</span> <span class="s">&quot;myAttachment.txt&quot;</span><span class="o">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Gatling will automatically set the <cite>Content-Type</cite> header to <cite>multipart/form-data</cite> if you didn’t specify one.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The MIME Type of the uploaded file defaults to <code class="docutils literal"><span class="pre">application/octet-stream</span></code> and the character set defaults to the one configured in <code class="docutils literal"><span class="pre">gatling.conf</span></code> (<code class="docutils literal"><span class="pre">UTF-8</span></code> by default).
Don’t forget to override them when needed.
Then, directly use a body part, e.g. <code class="docutils literal"><span class="pre">.bodyPart(RawFileBodyPart(&quot;file&quot;,</span> <span class="pre">data.xls&quot;).contentType(&quot;application/vnd.ms-excel&quot;).fileName(&quot;data.xls&quot;)).asMultipartForm</span></code>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There is a helpful method to help you deal with multipart form requests: <code class="docutils literal"><span class="pre">asMultipartForm</span></code>.
It is equivalent to <code class="docutils literal"><span class="pre">header(HttpHeaderNames.ContentType,</span> <span class="pre">HttpHeaderValues.MultipartFormData)</span></code>.
If you use <code class="docutils literal"><span class="pre">formUpload</span></code> the header is automatically set for you.</p>
</div>
</div>
<div class="section" id="request-body">
<span id="http-request-body"></span><h2>Request Body<a class="headerlink" href="#request-body" title="Permalink to this headline">¶</a></h2>
<p>You can add a full body to an HTTP request with the dedicated method <code class="docutils literal"><span class="pre">body(body)</span></code>, where body can be:</p>
<ul class="simple" id="http-request-body-rawfile">
<li><code class="docutils literal"><span class="pre">RawFileBody(path:</span> <span class="pre">Expression[String])</span></code> where path is the location of a file that will be uploaded as is</li>
</ul>
<p><code class="docutils literal"><span class="pre">RawFileBody</span></code> lets you pass a raw file that will be sent as is.
Over regular HTTP, Gatling can optimise sending such a body and directly stream from the file to the socket, without copying in memory.
Of course, this optimisation is disabled over HTTPS, as bytes have to be encoded, i.e. loaded in memory.:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="c1">// myFileBody.json is a file that contains</span>
<span class="c1">// { &quot;myContent&quot;: &quot;myHardCodedValue&quot; }</span>
<span class="o">.</span><span class="n">body</span><span class="o">(</span><span class="nc">RawFileBody</span><span class="o">(</span><span class="s">&quot;myFileBody.json&quot;</span><span class="o">)).</span><span class="n">asJSON</span>
</pre></div>
</div>
<ul class="simple" id="http-request-body-elfile">
<li><code class="docutils literal"><span class="pre">ElFileBody(path:</span> <span class="pre">Expression[String])</span></code> where path is the location of a file whose content will be parsed and resolved with Gatling EL engine</li>
</ul>
<p>Here, the file content is parsed and turned into a Gatling EL expression.
Of course, it can’t be binary.:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="c1">// myFileBody.json is a file that contains</span>
<span class="c1">// { &quot;myContent&quot;: &quot;${myDynamicValue}&quot; }</span>
<span class="o">.</span><span class="n">body</span><span class="o">(</span><span class="nc">ElFileBody</span><span class="o">(</span><span class="s">&quot;myFileBody.json&quot;</span><span class="o">)).</span><span class="n">asJSON</span>
</pre></div>
</div>
<ul class="simple" id="http-request-body-string">
<li><code class="docutils literal"><span class="pre">StringBody(string:</span> <span class="pre">Expression[String])</span></code></li>
</ul>
<p>Here, you can pass a raw String, a Gatling EL String, or an Expression function.:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">body</span><span class="o">(</span><span class="nc">StringBody</span><span class="o">(</span><span class="s">&quot;&quot;&quot;{ &quot;myContent&quot;: &quot;myHardCodedValue&quot; }&quot;&quot;&quot;</span><span class="o">)).</span><span class="n">asJSON</span>

<span class="o">.</span><span class="n">body</span><span class="o">(</span><span class="nc">StringBody</span><span class="o">(</span><span class="s">&quot;&quot;&quot;{ &quot;myContent&quot;: &quot;${myDynamicValue}&quot; }&quot;&quot;&quot;</span><span class="o">)).</span><span class="n">asJSON</span>

<span class="o">.</span><span class="n">body</span><span class="o">(</span><span class="nc">StringBody</span><span class="o">(</span><span class="n">session</span> <span class="k">=&gt;</span> <span class="s">&quot;&quot;&quot;{ &quot;myContent&quot;: &quot;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="n">someGenerator</span><span class="o">(</span><span class="n">session</span><span class="o">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;&quot; }&quot;&quot;&quot;</span><span class="o">)).</span><span class="n">asJSON</span>
</pre></div>
</div>
<ul class="simple" id="http-request-body-bytes">
<li><code class="docutils literal"><span class="pre">ByteArrayBody(bytes:</span> <span class="pre">Expression[Array[Byte]])</span></code></li>
</ul>
<p id="http-request-body-stream">Here, you can pass bytes instead of text.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">InputStreamBody(stream:</span> <span class="pre">Expression[InputStream])</span></code></li>
</ul>
<p>Here, you can pass a Stream.</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">body</span><span class="o">(</span><span class="nc">PebbleStringBody</span><span class="o">(</span><span class="s">&quot;&quot;&quot;{ &quot;myContent&quot;: &quot;{myDynamicValue}&quot; }&quot;&quot;&quot;</span><span class="o">)).</span><span class="n">asJSON</span>

<span class="c1">// myFileBody.json is a file that contains</span>
<span class="c1">// { &quot;myContent&quot;: &quot;{myDynamicValue}&quot; }</span>
<span class="o">.</span><span class="n">body</span><span class="o">(</span><span class="nc">PebbleFileBody</span><span class="o">(</span><span class="s">&quot;myFileBody.json&quot;</span><span class="o">)).</span><span class="n">asJSON</span>
</pre></div>
</div>
<p>Gatling Expression Language is definitively the most optimized templating engine for Gatling, in terms of raw performance. However, it’s a bit limited in terms of logic you can implement in there.
If you want loops and conditional blocks, you can use Gatling’s <a class="reference external" href="http://mitchellbosecke.com/pebble/home">Pebble</a> based templating engine.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When you pass a path, Gatling searches first for an absolute path in the classpath and then in the <code class="docutils literal"><span class="pre">bodies</span></code> directory.</p>
</div>
<p>Note that one can take full advantage of Scala 2.10 macros for writing template directly in Scala compiled code instead of relying on a templating engine.
See <a class="reference external" href="http://docs.scala-lang.org/overviews/core/string-interpolation.html">Scala 2.10 string interpolation</a> and <a class="reference external" href="https://github.com/Atry/fastring">Fastring</a>.</p>
<p>For example:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">object</span> <span class="nc">Templates</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">template</span><span class="k">:</span> <span class="kt">Expression</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">(</span><span class="n">session</span><span class="k">:</span> <span class="kt">Session</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="k">for</span> <span class="o">{</span>
      <span class="n">foo</span> <span class="k">&lt;-</span> <span class="n">session</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">).</span><span class="n">validate</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
      <span class="n">bar</span> <span class="k">&lt;-</span> <span class="n">session</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">).</span><span class="n">validate</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
    <span class="o">}</span> <span class="k">yield</span> <span class="s">s&quot;&quot;&quot;{ foo: </span><span class="si">$foo</span><span class="s">, bar: </span><span class="si">$bar</span><span class="s"> }&quot;&quot;&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For simple use cases, prefer EL strings or based files, for more complex ones where programming capability is required, prefer String interpolation or Fastring.</p>
</div>
</div>
<div class="section" id="multipart-request">
<span id="http-request-body-parts"></span><h2>Multipart Request<a class="headerlink" href="#multipart-request" title="Permalink to this headline">¶</a></h2>
<p>You can add a multipart body to an HTTP request and add parts with the dedicated method <code class="docutils literal"><span class="pre">bodyPart(bodyPart)</span></code>, where bodyPart can be:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">RawFileBodyPart(path:</span> <span class="pre">Expression[String])</span></code></li>
<li><code class="docutils literal"><span class="pre">RawFileBodyPart(name:</span> <span class="pre">Expression[String],</span> <span class="pre">path:</span> <span class="pre">Expression[String])</span></code></li>
</ul>
<p>where path is the location of a file that will be uploaded as is.</p>
<p>Similar to <a class="reference internal" href="#http-request-body-rawfile"><span class="std std-ref">RawFileBody</span></a>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ElFileBodyPart(path:</span> <span class="pre">Expression[String])</span></code></li>
<li><code class="docutils literal"><span class="pre">ElFileBodyPart(name:</span> <span class="pre">Expression[String],</span> <span class="pre">path:</span> <span class="pre">Expression[String])</span></code></li>
</ul>
<p>where path is the location of a file whose content will be parsed and resolved with Gatling EL engine.</p>
<p>Similar to <a class="reference internal" href="#http-request-body-elfile"><span class="std std-ref">ElFileBody</span></a>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">StringBodyPart(string:</span> <span class="pre">Expression[String])</span></code></li>
<li><code class="docutils literal"><span class="pre">StringBodyPart(name:</span> <span class="pre">Expression[String],</span> <span class="pre">string:</span> <span class="pre">Expression[String])</span></code></li>
</ul>
<p>Similar to <a class="reference internal" href="#http-request-body-string"><span class="std std-ref">StringBody</span></a>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ByteArrayBodyPart(bytes:</span> <span class="pre">Expression[Array[Byte])</span></code></li>
<li><code class="docutils literal"><span class="pre">ByteArrayBodyPart(name:</span> <span class="pre">Expression[String],</span> <span class="pre">bytes:</span> <span class="pre">Expression[Array[Byte])</span></code></li>
</ul>
<p>Similar to <a class="reference internal" href="#http-request-body-bytes"><span class="std std-ref">ByteArrayBody</span></a>.</p>
<p>Once bootstrapped, BodyPart has the following methods for setting additional optional information:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">contentType(contentType:</span> <span class="pre">String)</span></code></li>
<li><code class="docutils literal"><span class="pre">charset(charset:</span> <span class="pre">String)</span></code>, part of of <code class="docutils literal"><span class="pre">Content-Type</span></code> header. If not set, defaults to the one from <code class="docutils literal"><span class="pre">gatling.conf</span></code> file.</li>
<li><code class="docutils literal"><span class="pre">fileName(fileName:</span> <span class="pre">Expression[String])</span></code>, part of the <em>Content-Disposition</em> header.</li>
<li><code class="docutils literal"><span class="pre">dispositionType(contentId:</span> <span class="pre">String)</span></code>, part of the <code class="docutils literal"><span class="pre">Content-Disposition</span></code> header. If not set, defaults to <code class="docutils literal"><span class="pre">form-data</span></code>.</li>
<li><code class="docutils literal"><span class="pre">contentId(contentId:</span> <span class="pre">Expression[String])</span></code></li>
<li><code class="docutils literal"><span class="pre">transferEncoding(transferEncoding:</span> <span class="pre">String)</span></code></li>
<li><code class="docutils literal"><span class="pre">header(name:</span> <span class="pre">String,</span> <span class="pre">value:</span> <span class="pre">Expression[String])</span></code>, let you define additional part headers</li>
</ul>
</div>
<div class="section" id="request-body-processor">
<span id="http-request-body-processor"></span><h2>Request Body Processor<a class="headerlink" href="#request-body-processor" title="Permalink to this headline">¶</a></h2>
<p>You might want to process the request body before it’s being sent to the wire.</p>
<p><code class="docutils literal"><span class="pre">processRequestBody(processor:</span> <span class="pre">Body</span> <span class="pre">=&gt;</span> <span class="pre">Body)</span></code>: takes a <code class="docutils literal"><span class="pre">Body</span> <span class="pre">=&gt;</span> <span class="pre">Body</span></code></p>
<p>Gatling ships two built-ins:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">gzipBody</span></code>: compress the request body with GZIP</li>
<li><code class="docutils literal"><span class="pre">streamBody</span></code>: turn the body into a stream</li>
</ul>
</div>
<div class="section" id="response-transformers">
<span id="http-response-transformer"></span><h2>Response Transformers<a class="headerlink" href="#response-transformers" title="Permalink to this headline">¶</a></h2>
<p>Similarly, one might want to process the response before it’s passed to the checks pipeline.</p>
<p><code class="docutils literal"><span class="pre">transformResponse(responseTransformer:</span> <span class="pre">PartialFunction[Response,</span> <span class="pre">Response])</span></code>: takes a <code class="docutils literal"><span class="pre">Response</span> <span class="pre">=&gt;</span> <span class="pre">Response</span></code></p>
<p>The example below shows how to decode some Base64 encoded response body:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">org.asynchttpclient.util.Base64</span>
<span class="k">import</span> <span class="nn">io.gatling.http.response._</span>
<span class="k">import</span> <span class="nn">java.nio.charset.StandardCharsets.UTF_8</span>

<span class="c1">// ignore when response isn&#39;t received (e.g. when connection refused)</span>
<span class="o">.</span><span class="n">transformResponse</span> <span class="o">{</span> <span class="k">case</span> <span class="n">response</span> <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">isReceived</span> <span class="k">=&gt;</span>
  <span class="k">new</span> <span class="nc">ResponseWrapper</span><span class="o">(</span><span class="n">response</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">override</span> <span class="k">val</span> <span class="n">body</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">ByteArrayResponseBody</span><span class="o">(</span><span class="nc">Base64</span><span class="o">.</span><span class="n">decode</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">string</span><span class="o">),</span> <span class="nc">UTF_8</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="resources">
<span id="http-resources"></span><h2>Resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h2>
<p>Gatling allow to fetch resources in parallel in order to emulate the behavior of a real web browser.</p>
<p>At the request level you can use the <code class="docutils literal"><span class="pre">resources(res:</span> <span class="pre">AbstractHttpRequestBuilder[_]*)</span></code> method.</p>
<p>For example:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">http</span><span class="o">(</span><span class="s">&quot;Getting issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://www.github.com/gatling/gatling/issues&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">resources</span><span class="o">(</span>
    <span class="n">http</span><span class="o">(</span><span class="s">&quot;api.js&quot;</span><span class="o">).</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://collector-cdn.github.com/assets/api.js&quot;</span><span class="o">),</span>
    <span class="n">http</span><span class="o">(</span><span class="s">&quot;ga.js&quot;</span><span class="o">).</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;https://ssl.google-analytics.com/ga.js&quot;</span><span class="o">)</span>
  <span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="response-chunks-discarding">
<span id="http-chunksdiscard"></span><h2>Response chunks discarding<a class="headerlink" href="#response-chunks-discarding" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">disableResponseChunksDiscarding</span></code> works just like the <a class="reference internal" href="http_protocol.html#http-protocol-chunksdiscard"><span class="std std-ref">protocol level parameter</span></a>, except that it targets this request only.</p>
</div>
</div>

          
        </div>
      </article>
    </main>
  </div>
</div>


<div class="sidebar-wrap col-md-3 content-left-wrap">
  <div id="secondary" class="widget-area" role="complementary" itemscope="itemscope"
       itemtype="http://schema.org/WPSideBar">
    <aside id="search-2" class="widget widget_search">
      <form role="form" method="get" class="search-form" action="../search.html">
        <label>
          <span class="screen-reader-text">Search through the documentation&nbsp;:</span>
          <input type="search" class="search-field" placeholder="Search the documentation" name="q">
        </label>
        <input type="submit" class="search-submit" value="Search">
      </form>
    </aside>
    <aside class="widget">
      <h1 class="widget-title">Table of Content</h1>
      <ul>
<li><a class="reference internal" href="#">HTTP Request</a><ul>
<li><a class="reference internal" href="#method-and-url">Method and URL</a></li>
<li><a class="reference internal" href="#query-parameters">Query Parameters</a></li>
<li><a class="reference internal" href="#headers">Headers</a></li>
<li><a class="reference internal" href="#signature-calculator">Signature Calculator</a></li>
<li><a class="reference internal" href="#authentication">Authentication</a></li>
<li><a class="reference internal" href="#outgoing-proxy">Outgoing Proxy</a></li>
<li><a class="reference internal" href="#virtual-host">Virtual Host</a></li>
<li><a class="reference internal" href="#http-checks">HTTP Checks</a></li>
<li><a class="reference internal" href="#followredirect">FollowRedirect</a></li>
<li><a class="reference internal" href="#url-encoding">Url Encoding</a></li>
<li><a class="reference internal" href="#silencing">Silencing</a></li>
<li><a class="reference internal" href="#form-parameters">Form Parameters</a></li>
<li><a class="reference internal" href="#multipart-form">Multipart Form</a></li>
<li><a class="reference internal" href="#request-body">Request Body</a></li>
<li><a class="reference internal" href="#multipart-request">Multipart Request</a></li>
<li><a class="reference internal" href="#request-body-processor">Request Body Processor</a></li>
<li><a class="reference internal" href="#response-transformers">Response Transformers</a></li>
<li><a class="reference internal" href="#resources">Resources</a></li>
<li><a class="reference internal" href="#response-chunks-discarding">Response chunks discarding</a></li>
</ul>
</li>
</ul>

    </aside>
    
    <aside class="widget">
      <h1 class="widget-title">Previous topic</h1>
      <ul>
        <li>
          <a href="http_protocol.html" title="Previous Chapter: HTTP Protocol">
            HTTP Protocol
          </a>
        </li>
      </ul>
    </aside>
    
    
    <aside class="widget">
      <h1 class="widget-title">Next topic</h1>
      <ul>
        <li>
          <a href="http_check.html" title="Next Chapter: Checks">
            Checks
          </a>
        </li>
      </ul>
    </aside>
    <aside class="widget">
      <h1 class="widget-title">Contribute</h1>
      <ul>
        <li>
          <a href="https://github.com/gatling/gatling/edit/master/src/sphinx/http/http_request.rst">Edit this page on Github</a>
        </li>
      </ul>
    </aside>
  </div>
</div>





